# spreadCocoa_log

接触確認アプリCOCOAで、動作情報をzipファイルで保存できるようになりました。
そのzipファイルには最大14のcsvファイルが入っており、内容を目視確認するまでのファイル操作が煩雑でした。
このGoogle Apps Scriptは、gmailの添付ファイルで  cocoa_log xx .zip  を受信した際に、スターと、cocoaLogというラベルを付けた状態で実行します。
すると、予め指定したGoogleDriveのフォルダーに添付ファイルをzipのまま、送信者名などをファイル名に付与して保存し、かつ、新しいSpreadSheetを自動生成し、最大14のｃｓｖをそれぞれのシートにします。

Google Apps Script を使うことができる人向けです。

cocoa_logの読み方は、こちらの「接触日シート別冊p.2」に整理しています。
https://datastudio.google.com/reporting/069598a2-3f01-4b51-b023-cdb478992182/page/2pXIC

コードは、対価不要で自由に改変してご活用いただけます。思い通りの動作をしていない部分がありますので、自己責任でお願いします。

特に、Androidユーザーさまは、OS側で提供キーの一致がでても、ハッシュ値から接触日を推定することができません。

しかし、このcocoa_logの「output_date」と「DaysSinceLastExposure:」の値から、広範な接触（１m以内１５分以上の濃厚接触ではない陽性登録者さんとのすれ違い）の日付を推定できます。
この接触日の推定値を使って、ご自身やご家族又は職場の方などの感染リスクを把握して、社会経済活動をしつつ、リスクの少ない行動を賢く実践いただけたらと思います。

スプレッドシートに展開したログを記録するように改変予定です。
